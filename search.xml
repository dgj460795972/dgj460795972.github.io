<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>太原地铁</title>
    <url>/%E5%A4%AA%E5%8E%9F%E5%9C%B0%E9%93%81/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>太原从2009年开始筹备建设地铁，3年时间，2012年太原2号线一期工程设计启动，2016年，2号线工程全面开工建设，至2020年12月，地铁全面开通。从启动到开通运营，8年时光。</p>
<span id="more"></span>
<h2 id="2009"><a href="#2009" class="headerlink" title="2009"></a>2009</h2><p><strong>4月8日</strong> &emsp;太原市政府成立“太原市轨道交通建设领导组”<br><strong>11月2日</strong>   &emsp;市政府成立太原市轨道交通建设筹备处</p>
<h2 id="2010"><a href="#2010" class="headerlink" title="2010"></a>2010</h2><p><strong>12月1日</strong>  &emsp;太原市城市轨道交通线网规划获市政府批复<br><strong>12月31日</strong>   &emsp;山西省发改委向国家发改委上报《太原市城市轨道交通建设规划》</p>
<h2 id="2011"><a href="#2011" class="headerlink" title="2011"></a>2011</h2><p><strong>7月15日</strong>   &emsp;太原市政府常务会审议通过《太原市城市交通发展规划》<br><strong>12月31日</strong>  &emsp;山西省发改委向国家发改委上报《太原市城市轨道交通建设规划》</p>
<h2 id="2012"><a href="#2012" class="headerlink" title="2012"></a>2012</h2><p><strong>5月10日</strong>   &emsp;太原轨道交通发展有限公司成立<br><strong>6月18日</strong>   &emsp;太原市城市轨道交通近期建设规划获国家发改委批复<br><strong>12月17日</strong>   &emsp;2号线一期工程设计启动</p>
<h2 id="2013"><a href="#2013" class="headerlink" title="2013"></a>2013</h2><p><strong>8月2日</strong>   &emsp;2号线一期可行性研究报告获省发改委批复<br><strong>9月13日</strong>   &emsp;首开段（中心街西站及中心街西站—南中环街站区间）初步设计获省发改委批复<br><strong>11月2日</strong>   &emsp;首开段中心街西站开工建设</p>
<h2 id="2014"><a href="#2014" class="headerlink" title="2014"></a>2014</h2><p><strong>4月1日</strong>   &emsp;2号线一期工程初步设计获省发改委批复</p>
<h2 id="2016"><a href="#2016" class="headerlink" title="2016"></a>2016</h2><p><strong>3月15日</strong>   &emsp;2号线一期工程全线开工建设<br><strong>5月1日</strong>   &emsp;太原市城市轨道交通线网规划修编获市政府批复</p>
<h2 id="2017"><a href="#2017" class="headerlink" title="2017"></a>2017</h2><p><strong>4月22日</strong>   &emsp;首台盾构机“龙城一号”在中心街站始发</p>
<h2 id="2018"><a href="#2018" class="headerlink" title="2018"></a>2018</h2><p><strong>2月28日</strong>   &emsp;全线实现“洞通”</p>
<h2 id="2019"><a href="#2019" class="headerlink" title="2019"></a>2019</h2><p><strong>7月16日</strong>   &emsp;太原中铁轨道交通建设运营有限公司成立<br><strong>8月12日</strong>   &emsp;车站主体结构全面封顶<br><strong>12月31日</strong>  &emsp; 全线实现“轨通”“电通”</p>
<h2 id="2020"><a href="#2020" class="headerlink" title="2020"></a>2020</h2><p><strong>5月4日</strong>   &emsp;首列车抵达贾家寨车辆基地<br><strong>9月1日</strong>   &emsp;开始空载试运行<br><strong>10月23日</strong>  &emsp; 初期运营行车方案通过评审<br><strong>11月1日</strong>   &emsp;按开通载客标准进入“跑图”模式<br><strong>12月6日</strong>   &emsp;太原市轨道交通2号线一期工程顺利通过竣工验收<br><strong>12月19日</strong>   &emsp;太原市轨道交通2号线一期工程通过初期运营前安全评估<br><strong>12月26日</strong>   &emsp;太原地铁2号线正式开通运营</p>
]]></content>
      <categories>
        <category>不停在路上</category>
        <category>太原</category>
        <category>太原地铁</category>
      </categories>
      <tags>
        <tag>不停</tag>
        <tag>太原地铁</tag>
      </tags>
  </entry>
  <entry>
    <title>TCP协议</title>
    <url>/TCP%E5%8D%8F%E8%AE%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>TCP，是一种可靠的、面向连接的<strong>字节流</strong>服务。通过<strong>序号</strong>对发送的数据报进行标记，同时对每个数据段进行<strong>确认</strong>。</p>
<span id="more"></span>
<h2 id="TCP报文首部格式"><a href="#TCP报文首部格式" class="headerlink" title="TCP报文首部格式"></a>TCP报文首部格式</h2><p><img src="http://blog.dingguojing.xyz/images/ruankao/tcp.png" alt="TCP"></p>
<h3 id="源端口和目的端口"><a href="#源端口和目的端口" class="headerlink" title="源端口和目的端口"></a>源端口和目的端口</h3><p>该字段均为16位，通过使用端口来标识源端和目的端的应用进程，比如Http，基于TCP协议，目的端端口为80.</p>
<h3 id="序列号和确认号"><a href="#序列号和确认号" class="headerlink" title="序列号和确认号"></a>序列号和确认号</h3><p>序列号是指每一个TCP报文段的序号，下一个TCP报文段的序号值等于上一个报文段序号加上该报文的长度。<br>确认号是指，发送端下一个报文段的第一个数据字段的序号。</p>
<h3 id="报头长度"><a href="#报头长度" class="headerlink" title="报头长度"></a>报头长度</h3><p>报头长度为4字节，32位。能取到最大值为15。为了保证报头长度是32位的倍数，所以TCP报头长度最多有60字节，没有任何选项的TCP报头长度为20字节。</p>
<h3 id="保留字段"><a href="#保留字段" class="headerlink" title="保留字段"></a>保留字段</h3><p>保留字段6字节，通常设置为0</p>
<h3 id="标记字段"><a href="#标记字段" class="headerlink" title="标记字段"></a>标记字段</h3><p>6个标记字段。</p>
<ul>
<li>URG，表示紧急指针，需要尽快传送</li>
<li>ACK，建立连接后的报文回应，设置为1</li>
<li>PSH, <strong>接收端</strong> 应用程序应该立即从TCP接收缓冲区中读走数据,交给上层协议。</li>
<li>RST，要求对方重新建立连接。</li>
<li>SYN，建立连接。</li>
<li>FIN，释放连接。</li>
</ul>
<h3 id="窗口大小"><a href="#窗口大小" class="headerlink" title="窗口大小"></a>窗口大小</h3><p>该字段用来进行流量控制，作为接收方让发送方设置其发送窗口的依据。告诉对方本端的TCP接收缓冲区还能容纳多少字节的数据，这样对方就可以控制发送数据的速度。</p>
<h3 id="16位校验和"><a href="#16位校验和" class="headerlink" title="16位校验和"></a>16位校验和</h3><p>由 <strong>发送端</strong> 填充，接收端对TCP报文段执行CRC算法以检验TCP报文段在传输过程中是否损坏。注意，这个校验不仅包括TCP头部，也包括数据部分。</p>
<h3 id="16位紧急指针"><a href="#16位紧急指针" class="headerlink" title="16位紧急指针"></a>16位紧急指针</h3><p>是一个正的偏移量。它和序号字段的值相加表示最后一个紧急数据的下一字节的序号。因此，确切地说，这个字段是紧急指针相对当前序号的偏移，不妨称之为紧急偏移。TCP的紧急指针是发送端向接收端发送紧急数据的方法。</p>
<h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><p>该字段长度可变到40字节，为了保证TCP头部是32位的倍数，需要填充0</p>
<h2 id="TCP连接过程"><a href="#TCP连接过程" class="headerlink" title="TCP连接过程"></a>TCP连接过程</h2><blockquote>
<p>Tcp通过3次握手建立连接，双方通信之前均处于closed状态。</p>
</blockquote>
<p><img src="http://blog.dingguojing.xyz/images/ruankao/tcp_3.png" alt="3次握手"></p>
<h3 id="第一次握手"><a href="#第一次握手" class="headerlink" title="第一次握手"></a>第一次握手</h3><p>建立连接时，<strong>客户端发送</strong> syn包（SYN=1，seq=x）到服务器，并 <strong>进入SYN_SENT</strong> 状态，等待服务器确认；SYN：同步序列编号，若没有收到对方的应答，状态变为CLOSED。</p>
<h3 id="第二次握手"><a href="#第二次握手" class="headerlink" title="第二次握手"></a>第二次握手</h3><p>服务器收到syn包，必须确认客户的SYN（ACK=1，ack=x+1），同时自己也发送一个SYN包（SYN=1，seq=y），即SYN+ACK包，此时服务器 <strong>进入SYN_RECV</strong> 状态。</p>
<h3 id="第三次握手"><a href="#第三次握手" class="headerlink" title="第三次握手"></a>第三次握手</h3><p>客户端收到服务器的SYN+ACK包，进入 <strong>ESTABLISHED（TCP连接成功）状态</strong> ，向服务器回送确认包ACK(ack=y+1，ACK=1，seq=x+1），此包发送完毕，服务器进入 <strong>ESTABLISHED（TCP连接成功）状态</strong>，完成三次握手。</p>
<h2 id="TCP释放连接"><a href="#TCP释放连接" class="headerlink" title="TCP释放连接"></a>TCP释放连接</h2><blockquote>
<p>tcp释放连接分为四步，通信之前均处于ESTABLISHED状态</p>
</blockquote>
<p><img src="http://blog.dingguojing.xyz/images/ruankao/tcp_4.png" alt="tcp释放连接"></p>
<h3 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h3><p>源主机发送释放报文（FIN=1，seq=x），源主机进入 <strong>FIN-WAIT</strong> 状态</p>
<h3 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h3><p>目标主机接收报文发出确认报文（ACK=1，确认序号ack=x+1，自身序号seq=y），进入 <strong>CLOSE-WAIT</strong> 状态。这时候，源主机停止发送数据，目标主机仍然可以发送，TCP连接为半关闭状态（HALF-CLOSE）。源主机接收到ACK报文等待目标主机发出FIN报文，会持续一段时间。</p>
<h3 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h3><p>目标主机，发出释放报文（FIN=1，ACK=x+1，seq=z），目标主机进入 <strong>LAST-ACK</strong> 状态。</p>
<h3 id="第四步"><a href="#第四步" class="headerlink" title="第四步"></a>第四步</h3><p>源主机收到释放报文，发送确认报文（ACK=1，确认序号ACK=z+1，自身序号seq=x+1），等待一段时间后，源主机进入 <strong>CLOSED</strong> 状态</p>
]]></content>
      <categories>
        <category>软考</category>
        <category>传输层</category>
      </categories>
      <tags>
        <tag>TCP</tag>
      </tags>
  </entry>
  <entry>
    <title>备忘录</title>
    <url>/%E5%A4%87%E5%BF%98%E5%BD%95/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="8fd132cf874a350055ca0b4eb1254eb5b4ba69dee7d0c29bba21a42886760eb8">ba4ccabb47f4e111770a40fee985fbed8b4b0f4ef659bfb92af0245836181c5743ec088bbdd09246099f951da7be770443314b3672a30396bf1c145f5990ff6380997de24e805be1c4b88f0049740579cf82d877260be1db891fb457306aa26a14d149d3fc5106ecaee89c06f2ed75b0139f61e661640d0461bf9e97a11d01dc1db308d104f97b5bd7334e75ea4d76f349ae131f9d1786670837bfb43acf628dca7d0f249f403412281477f0648474b51d35c5f2d7c894b47b8f370d972a7efbf96516d4c2af24913e41de121bd58f3d6f9ce80932b10f99b7603c7cfd973cfb311c8b3b4b0b23d8c9b1af87636ee792a9193d7d72b23dbfcc30b4af9a14cd97b927a872b95198f2bdbd734100a61a815ab806ed4f269127f7e4d370f6e73ccca0ecda57dfefea5026571afa91b4b6cd8e6e2777feb3697907dd6029dfed655cdf8ef01d2732850248c6d7cfe14fce182af0565e926ad09373fda5ceba2b3bc281b83434916b3ffaf92c290a12087fdbf4568ae72125961acf639e7f2b3225afc2a02899932d06c40b219ae2579da5248902cdc0f4a2c9b0c9505ab9838f486ab46bfab160b57c15d29f3948855cd257b5ef35d11955d9cecafb06231103c60a36e0cbb18ab881055597b1ec7629e4a321f7cd772b0507250910b91e7083bcef3e104b4cd531d620555d4c871e7d5f20755fd2dc84deed9f7d3ad6e9e1af9c6bf36786d1dfb7080bc7eabfde024a3aed771648a57a9376410996ce9fbe1c3ef13f54c6f8df0c1df20bb4d364c0319f951952505e0f881db3535c89df866cb83d1488a69228d2c3a67398c1757d2178fdc888b487c5a32c7a6e0c10b856a79b55f78a51649cf1aa5de3a19f1f3e16a31aa9d166c8a7b6dc6fe7dcf23811b20708813e966ef3f739df8be24ddca0b2127d07a832f7973cf9cc950395c4401e8541e12450f47bb769e024dd66c7b77bf450466bfaa93cd19d42e1fb4000d68662dcf9b6642c54df9e4299a68b199d79153251f46b9bfb244dc7956efa32c0f42edc64a07f861a660ecdaaeb4c86ea7fcb6e426623b33fbe5b5e5a95e472ec7c76df7bf2f40eb512b11cdb731543a40dde90</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>不停</tag>
      </tags>
  </entry>
  <entry>
    <title>python能做什么</title>
    <url>/python%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>学习一门编程语言，首先我们要知道可以用他来做什么，他主要应用在哪些方面，大而全，系统的去了解，之后从某一方面侧重点的去规划自己的目标。python可以从以下几个大的方面去概括，归纳。</p>
<span id="more"></span>
<h2 id="web开发"><a href="#web开发" class="headerlink" title="web开发"></a>web开发</h2><p>python可以用来进行web开发，比如我们学习到的django框架、flask框架。国内的一些网站，知乎、豆瓣、饿了吗、美团以及搜狐，国外的YouTube视频等都是用python编写的。</p>
<h2 id="大数据处理"><a href="#大数据处理" class="headerlink" title="大数据处理"></a>大数据处理</h2><p>python可以进行数据分析，借助第三方的数据处理框架开发大数据处理平台，进行金融分析，量化交易处理。</p>
<h2 id="网络爬虫"><a href="#网络爬虫" class="headerlink" title="网络爬虫"></a>网络爬虫</h2><p>python提供的标准支持库，可以从网页上爬到我们想要的数据，此外，python还有大量的爬虫框架，可以让我们去选择，获取网上的各种数据。</p>
<h2 id="自动运维开发"><a href="#自动运维开发" class="headerlink" title="自动运维开发"></a>自动运维开发</h2><h2 id="人工智能"><a href="#人工智能" class="headerlink" title="人工智能"></a>人工智能</h2><h2 id="云计算"><a href="#云计算" class="headerlink" title="云计算"></a>云计算</h2><h2 id="游戏开发"><a href="#游戏开发" class="headerlink" title="游戏开发"></a>游戏开发</h2><h2 id="图形、图像处理"><a href="#图形、图像处理" class="headerlink" title="图形、图像处理"></a>图形、图像处理</h2><h2 id="数据库编程"><a href="#数据库编程" class="headerlink" title="数据库编程"></a>数据库编程</h2>]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python类中的方法</title>
    <url>/python%E7%B1%BB%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>类，具有相同属性和行为的一类实体。类，具有属性和方法。python类中的方法有3类，实例方法、类方法、静态方法。</p>
<span id="more"></span>
<h2 id="实例方法"><a href="#实例方法" class="headerlink" title="实例方法"></a>实例方法</h2><p>对象调用的话，自动绑定self参数。类调用的话，不会自动绑定，必须传入对象参数。</p>
<h2 id="类方法"><a href="#类方法" class="headerlink" title="类方法"></a>类方法</h2><p>@classmethod，对象还是类调用，都会自动绑定参数。</p>
<h2 id="静态方法"><a href="#静态方法" class="headerlink" title="静态方法"></a>静态方法</h2><p>@staticmethod，对象、类调用，都不会自动绑定参数。</p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python基础面试</title>
    <url>/python%E9%9D%A2%E8%AF%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>python面试，实际就是对python知识掌握能力的一种鉴定。通过面试，可以更好的掌握自己学到的知识。</p>
<span id="more"></span>
<h2 id="导入模块"><a href="#导入模块" class="headerlink" title="导入模块"></a>导入模块</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import module # 导入模块</span><br><span class="line">from module import member # 从模块中导入某成员</span><br><span class="line">from module import *  # 从模块中导入所有的成员</span><br><span class="line">import module as m  # 增加别名的方式</span><br></pre></td></tr></table></figure>


<h2 id="设置python模块的搜索路径"><a href="#设置python模块的搜索路径" class="headerlink" title="设置python模块的搜索路径"></a>设置python模块的搜索路径</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">设置PYTHONPATN变量 PYTHONPATH = &#x27;path&#x27;</span><br><span class="line">通过sys.path临时设置python模块包的路径，sys.path.append(&#x27;path&#x27;)</span><br><span class="line">在python安装路径site-packages下增加一个后缀为.pth文件，增加为模块包的路径</span><br></pre></td></tr></table></figure>


<h2 id="字符串和变量的连接"><a href="#字符串和变量的连接" class="headerlink" title="字符串和变量的连接"></a>字符串和变量的连接</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 字符串和字符串的连接</span><br><span class="line">s1 = &#x27;hello&#x27;</span><br><span class="line">s2 = &#x27;world&#x27;</span><br><span class="line">s = s1 + s2   # 使用+号</span><br><span class="line">s = &#x27;hello&#x27;&#x27;world&#x27; # 直接连接</span><br><span class="line">s = print(s1, s2) # 使用print()函数</span><br><span class="line">s = &#x27;%s %s&#x27; % (s1, s2) # 格式化</span><br><span class="line">s = &#x27;&#x27;.join([s1, s2]) # 使用join</span><br><span class="line"># 通过格式化可以实现字符串和其他变量类型的连接，使用str()函数进行连接</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="进制之间的转换"><a href="#进制之间的转换" class="headerlink" title="进制之间的转换"></a>进制之间的转换</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n = 123</span><br><span class="line">n1 = 0b1101</span><br><span class="line">n2 = 0o723</span><br><span class="line">n3 = 0xabc</span><br><span class="line"># 进制转换函数</span><br><span class="line">bin()、oct()、hex()、int()四个函数</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>python</category>
        <category>python面试</category>
      </categories>
      <tags>
        <tag>python面试</tag>
      </tags>
  </entry>
  <entry>
    <title>正则表达式</title>
    <url>/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>python正则表达式，可以匹配任意类型的字符串，特别是在爬虫中的应用。</p>
<span id="more"></span>
<h2 id="单字符的匹配"><a href="#单字符的匹配" class="headerlink" title="单字符的匹配"></a>单字符的匹配</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 匹配某个字符串，match只能从第一个字符开始匹配,返回一个match对象</span></span><br><span class="line"><span class="comment"># text = &#x27;abc&#x27;</span></span><br><span class="line"><span class="comment"># ret = re.match(&#x27;a&#x27;, text)</span></span><br><span class="line"><span class="comment"># print(ret.group())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 匹配任意字符(.),不能匹配&#x27;\n&#x27;</span></span><br><span class="line"><span class="comment"># text = &#x27;abc&#x27;</span></span><br><span class="line"><span class="comment"># ret = re.match(&#x27;.&#x27;, text)</span></span><br><span class="line"><span class="comment"># print(ret.group())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># \d匹配任意的数字</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># \D匹配任意非数字</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># \s匹配的是空白字符(\n,\t,\r\n window下换行,空格)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># \S匹配的为非空白字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># \w匹配的a-zA-Z,数字及下划线</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># \W匹配的和\w相反</span></span><br><span class="line">text = <span class="string">&#x27;+abc&#x27;</span></span><br><span class="line">ret = re.match(<span class="string">&#x27;\W&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(ret.group())</span><br><span class="line"></span><br><span class="line"><span class="comment"># []组合的方式，只要满足括号内某一项就可以匹配成功</span></span><br></pre></td></tr></table></figure>
<h2 id="多字符的匹配"><a href="#多字符的匹配" class="headerlink" title="多字符的匹配"></a>多字符的匹配</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># * 匹配0个或多个字符</span></span><br><span class="line">text = <span class="string">&#x27;abc&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;\w*&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br><span class="line"></span><br><span class="line"><span class="comment"># + 匹配一个或多个</span></span><br><span class="line"><span class="comment"># text = &#x27;+abc&#x27;</span></span><br><span class="line"><span class="comment"># result = re.match(&#x27;\w+&#x27;, text)</span></span><br><span class="line"><span class="comment"># print(result.group())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ？匹配0个或一个</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;m&#125; 匹配m个字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;m,n&#125;匹配m-n之间个数的字符</span></span><br><span class="line">text = <span class="string">&#x27;3+2abc&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;\w&#123;1,3&#125;&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br></pre></td></tr></table></figure>
<h2 id="开始和结束字符串的匹配"><a href="#开始和结束字符串的匹配" class="headerlink" title="开始和结束字符串的匹配"></a>开始和结束字符串的匹配</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># ^ 匹配开始字符</span></span><br><span class="line">text = <span class="string">&#x27;Hello World&#x27;</span></span><br><span class="line">result = re.search(<span class="string">&#x27;Wo&#x27;</span>, text)</span><br><span class="line"><span class="comment"># result1 = re.match(&#x27;Wo&#x27;, text)</span></span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br><span class="line"><span class="comment"># print(result1.group())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># $ 匹配结束字符</span></span><br><span class="line">text = <span class="string">&#x27;Hello World&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;Hello&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br><span class="line"></span><br><span class="line"><span class="comment"># | 匹配多个字符或表达式</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 贪婪或者非贪婪</span></span><br><span class="line">text = <span class="string">&#x27;123456&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;\d+?&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取html中标签</span></span><br><span class="line">text = <span class="string">&#x27;&lt;h1&gt;这是一个标题&lt;/h1&gt;&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;&lt;.+&gt;&#x27;</span>, text) <span class="comment"># 贪婪模式</span></span><br><span class="line"><span class="comment"># result = re.match(&#x27;&lt;.+?&gt;&#x27;, text) # 非贪婪模式</span></span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证一个字符是不是0-100之间的数字 0 1 23 99</span></span><br><span class="line">num = <span class="built_in">input</span>(<span class="string">&#x27;请输入一个数：&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(num))</span><br><span class="line"><span class="comment"># num = &#x27;25&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;0$|[1-9]\d?$|100$&#x27;</span>, num)</span><br><span class="line"><span class="comment"># print(type(result))</span></span><br><span class="line"><span class="keyword">if</span> result:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;你输入的是1-100的数:&#x27;</span>, result.group())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;你输入的不是1-100之间的数&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="转义字符和原生字符串的匹配"><a href="#转义字符和原生字符串的匹配" class="headerlink" title="转义字符和原生字符串的匹配"></a>转义字符和原生字符串的匹配</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment"># python中的转义字符,加\</span></span><br><span class="line">text = <span class="string">&#x27;Hello\\nWorld&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 正则中的转义字符,加\</span></span><br><span class="line">s = <span class="string">&#x27;apple is $34, range is $78&#x27;</span></span><br><span class="line">result = re.findall(<span class="string">&#x27;\$\d+&#x27;</span>, s)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 原生字符和正则表达式</span></span><br><span class="line"><span class="comment"># 先在python中解析，再在正则中解析</span></span><br><span class="line">s = <span class="string">&#x27;\cdac&#x27;</span></span><br><span class="line">result = re.match(<span class="string">r&#x27;\\c&#x27;</span>, s)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br></pre></td></tr></table></figure>
<h2 id="分组、re模块常用函数"><a href="#分组、re模块常用函数" class="headerlink" title="分组、re模块常用函数"></a>分组、re模块常用函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分组</span></span><br><span class="line">s = <span class="string">&#x27;apple is $34, range is $78&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;.+(\$\d+).+(\$\d+)&#x27;</span>, s)</span><br><span class="line"><span class="built_in">print</span>(result.groups())</span><br><span class="line"></span><br><span class="line"><span class="comment"># group(0)或group()匹配整个字符串</span></span><br><span class="line"><span class="comment"># group(1)匹配第一个分组</span></span><br><span class="line"><span class="comment"># group(2)匹配第二个分组</span></span><br><span class="line"><span class="comment"># groups()匹配所有的分组</span></span><br><span class="line"><span class="comment"># findall()方法,返回的为一个列表</span></span><br><span class="line">s = <span class="string">&#x27;apple is $34, range is $78&#x27;</span></span><br><span class="line">result = re.findall(<span class="string">r&#x27;\$\d+&#x27;</span>, s)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sub()方法,替换规则</span></span><br><span class="line">s = <span class="string">&#x27;apple is $34, range is $78&#x27;</span></span><br><span class="line">result = s.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># result = re.sub(r&#x27; |,&#x27;, &#x27;|&#x27;, s)</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line">html = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;p&gt;这是一个p段落&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;p&gt;这是一个p段落&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;p&gt;这是一个p段落&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;p&gt;这是一个p段落&lt;/p&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">result = re.sub(<span class="string">r&#x27;&lt;.+?&gt;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, html)</span><br><span class="line"><span class="built_in">print</span>(result.strip())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给正则表达式加注释,使用compile函数编译正则规则</span></span><br><span class="line">s = <span class="string">&#x27;apple is 35.59&#x27;</span></span><br><span class="line">r = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">\d+ # 匹配一个数字</span></span><br><span class="line"><span class="string">\.? # 匹配一个小数点</span></span><br><span class="line"><span class="string">\d* # 匹配小数部分</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>, re.VERBOSE)</span><br><span class="line">result = re.search(r, s)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="验证可能要爬取得数据类型，手机号码、邮箱、身份证，url"><a href="#验证可能要爬取得数据类型，手机号码、邮箱、身份证，url" class="headerlink" title="验证可能要爬取得数据类型，手机号码、邮箱、身份证，url"></a>验证可能要爬取得数据类型，手机号码、邮箱、身份证，url</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment"># 验证手机号码</span></span><br><span class="line">text = <span class="string">&#x27;133456789015&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;1[34578]\d&#123;9&#125;&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证邮箱</span></span><br><span class="line">text = <span class="string">&#x27;sdfsf@qq.com&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;\w+@[a-z0-9]+\.[a-z]+&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证url，http、https、ftp</span></span><br><span class="line">text = <span class="string">&#x27;https://www.baidu.com/s?wd=compile&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;(https|http|ftp)://\S+&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证身份证</span></span><br><span class="line">text = <span class="string">&#x27;11234567891234567z&#x27;</span></span><br><span class="line">result = re.match(<span class="string">&#x27;\d&#123;17&#125;[\dxX]&#x27;</span>, text)</span><br><span class="line"><span class="built_in">print</span>(result.group())</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>python</category>
        <category>python爬虫</category>
      </categories>
      <tags>
        <tag>python爬虫</tag>
        <tag>python正则表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>python连接数据库</title>
    <url>/python%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>爬虫中储存数据的四种方式，有json，csv，excel，mysql数据库等方式。</p>
<span id="more"></span>
<h3 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="comment"># 连接数据库,参数有主机，端口，用户名，密码，数据表，编码方式,</span></span><br><span class="line">conn= pymysql.connect(host=<span class="string">&#x27;127.0.0.1&#x27;</span>, user=<span class="string">&#x27;root&#x27;</span>, port=<span class="number">3306</span>, password=<span class="string">&#x27;password&#x27;</span>, database=<span class="string">&#x27;csdn_crawler&#x27;</span>)</span><br><span class="line">cusor = conn.cursor()</span><br></pre></td></tr></table></figure>
<h3 id="查询数据库"><a href="#查询数据库" class="headerlink" title="查询数据库"></a>查询数据库</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查询，增删改查通过cusor来操作</span></span><br><span class="line">sql = <span class="string">&#x27;select id, title from article&#x27;</span></span><br><span class="line">result = cusor.execute(sql)</span><br><span class="line">result = cusor.fetchone()</span><br><span class="line"><span class="comment"># result = cusor.fetchall()</span></span><br><span class="line"><span class="comment"># result = cusor.fetchmany(2)</span></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<h3 id="插入数据库"><a href="#插入数据库" class="headerlink" title="插入数据库"></a>插入数据库</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 插入数据</span></span><br><span class="line"><span class="comment"># sql = &quot;insert into article (id, title, content) values (null, &#x27;dgj&#x27;, &#x27;dgj zr&#x27;)&quot;</span></span><br><span class="line">sql = <span class="string">&quot;insert into article (id, title, content) values (null, %s, %s)&quot;</span></span><br><span class="line">title = <span class="string">&#x27;zr&#x27;</span></span><br><span class="line">content = <span class="string">&#x27;zr dgj&#x27;</span></span><br><span class="line">cusor.execute(sql, (title, content))</span><br><span class="line">conn.commit()</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<h3 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 删除数据</span></span><br><span class="line">sql = <span class="string">&quot;delete from article where id = 1&quot;</span></span><br><span class="line">cusor.execute(sql)</span><br><span class="line">conn.commit()</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<h3 id="更新数据库"><a href="#更新数据库" class="headerlink" title="更新数据库"></a>更新数据库</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 更新数据库</span></span><br><span class="line">sql = <span class="string">&quot;update article set title=&#x27;丁梓翊&#x27; where id=2&quot;</span></span><br><span class="line">cusor.execute(sql)</span><br><span class="line">conn.commit()</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>python</category>
        <category>python爬虫</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python中的json包</title>
    <url>/python%E4%B8%AD%E7%9A%84json%E5%8C%85/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>json本质类型为字符串，在python中，可以通过json包中dumps，dump，loads，load函数进行字符串和对象的相互转换</p>
<span id="more"></span>
<h2 id="json中dumps函数"><a href="#json中dumps函数" class="headerlink" title="json中dumps函数"></a>json中dumps函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment">#  Serialize ``obj`` to a JSON formatted ``str``.</span></span><br><span class="line">books = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&#x27;python讲义&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;price&#x27;</span>: <span class="number">19</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;java讲义&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;price&#x27;</span>: <span class="number">222</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(books)) <span class="comment"># &lt;class &#x27;list&#x27;&gt;</span></span><br><span class="line">result = json.dumps(books, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment"># [&#123;&quot;name&quot;: &quot;python讲义&quot;, &quot;price&quot;: 19&#125;, &#123;&quot;name&quot;: &quot;java讲义&quot;, &quot;price&quot;: 222&#125;]</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(result)) <span class="comment"># &lt;class &#x27;str&#x27;&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="json中dump函数"><a href="#json中dump函数" class="headerlink" title="json中dump函数"></a>json中dump函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将 python对象转化为json，并写入文件中</span></span><br><span class="line"><span class="comment">#   Serialize ``obj`` as a JSON formatted stream to ``fp``</span></span><br><span class="line">fp =  <span class="built_in">open</span>(<span class="string">&#x27;books.json&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">json.dump(books, fp, ensure_ascii=<span class="literal">False</span>)  </span><br><span class="line">fp.close()</span><br></pre></td></tr></table></figure>
<h2 id="json中loads函数"><a href="#json中loads函数" class="headerlink" title="json中loads函数"></a>json中loads函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将json字符串转为python对象</span></span><br><span class="line"><span class="comment">#  Deserialize ``s`` (a ``str``, ``bytes`` or ``bytearray`` instance containing a JSON document) to a Python object.</span></span><br><span class="line">json_str = <span class="string">&#x27;[&#123;&quot;name&quot;: &quot;python讲义&quot;, &quot;price&quot;: 19&#125;, &#123;&quot;name&quot;: &quot;java讲义&quot;, &quot;price&quot;: 222&#125;]&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(json.loads(json_str)))</span><br></pre></td></tr></table></figure>
<h2 id="json中的load函数"><a href="#json中的load函数" class="headerlink" title="json中的load函数"></a>json中的load函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># json中load函数将json文件转为python对象</span></span><br><span class="line"><span class="comment"># Deserialize ``fp`` (a ``.read()``-supporting file-like object containing</span></span><br><span class="line">    a JSON document) to a Python <span class="built_in">object</span>.</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;books.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    <span class="built_in">list</span> = json.load(fp)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">list</span>))</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>python</category>
        <category>python Json</category>
      </categories>
      <tags>
        <tag>json</tag>
      </tags>
  </entry>
  <entry>
    <title>Execl和CSV存储数据</title>
    <url>/Execl%E5%92%8CCSV%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>数据一般通过excel，csv方式存储，在python中如何使用excel，csv读取写入数据呢？</p>
<span id="more"></span>
<h2 id="读取python中csv模块"><a href="#读取python中csv模块" class="headerlink" title="读取python中csv模块"></a>读取python中csv模块</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"> <span class="comment"># 每一条数据为列表</span></span><br><span class="line"><span class="comment"># with open(&#x27;data.csv&#x27;, &#x27;r&#x27;) as f:</span></span><br><span class="line"><span class="comment">#     reader = csv.reader(f)</span></span><br><span class="line"><span class="comment">#     for r in reader:</span></span><br><span class="line"><span class="comment">#         print(r[4])</span></span><br><span class="line"><span class="comment"># 获取的每一条数据为字典</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.csv&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.DictReader(f)</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> reader:</span><br><span class="line">        <span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure>
<h2 id="写入csv数据"><a href="#写入csv数据" class="headerlink" title="写入csv数据"></a>写入csv数据</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">headers = (<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;height&#x27;</span>)</span><br><span class="line"><span class="comment"># students = [(&#x27;dgj&#x27;,23,1.8),(&#x27;zr&#x27;,21,1.7),(&#x27;dzy&#x27;,12,1.2)]</span></span><br><span class="line">students = [</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;dgj&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">23</span>,<span class="string">&#x27;height&#x27;</span>:<span class="number">1.8</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;zr&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">21</span>,<span class="string">&#x27;height&#x27;</span>:<span class="number">1.7</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;dzy&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">12</span>,<span class="string">&#x27;height&#x27;</span>:<span class="number">1.2</span>&#125;</span><br><span class="line">]</span><br><span class="line"><span class="comment"># with open(&#x27;students.csv&#x27;, &#x27;w&#x27;, encoding=&#x27;utf-8&#x27;,newline=&#x27;&#x27;) as f:</span></span><br><span class="line"><span class="comment">#     writer = csv.writer(f)</span></span><br><span class="line"><span class="comment">#     writer.writerow(headers)</span></span><br><span class="line"><span class="comment">#     writer.writerows(students)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;students.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    writer = csv.DictWriter(f, headers)</span><br><span class="line">    writer.writeheader()</span><br><span class="line">    writer.writerows(students)</span><br></pre></td></tr></table></figure>
<h2 id="使用python中的xlrd读取excel数据"><a href="#使用python中的xlrd读取excel数据" class="headerlink" title="使用python中的xlrd读取excel数据"></a>使用python中的xlrd读取excel数据</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xlrd, xlwt</span><br><span class="line">workbook = xlrd.open_workbook(<span class="string">&#x27;210629.xls&#x27;</span>)</span><br><span class="line"><span class="comment"># # 获取所有sheet的名字</span></span><br><span class="line"><span class="comment"># sheet_names = workbook.sheet_names()</span></span><br><span class="line"><span class="comment"># print(sheet_names)</span></span><br><span class="line"><span class="comment"># # 通过索引获取sheet对象</span></span><br><span class="line"><span class="comment"># sheet = workbook.sheet_by_index(1)</span></span><br><span class="line"><span class="comment"># print(sheet.name)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># sheet = workbook.sheet_by_name(&#x27;山西&#x27;)</span></span><br><span class="line"><span class="comment"># print(sheet.name)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sheets = workbook.sheets()</span></span><br><span class="line"><span class="comment"># print(sheets)</span></span><br><span class="line"><span class="comment"># for sheet in sheets:</span></span><br><span class="line"><span class="comment">#     print(sheet.name)</span></span><br><span class="line"><span class="comment"># 获取sheet</span></span><br><span class="line">sheet = workbook.sheet_by_index(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 获取cell</span></span><br><span class="line"><span class="comment"># cell的数据类型类型 xlrd.XL_CELL_TEXT、xlrd.XL_CELL_NUMBER、xlrd.XL_CELL_DATE、xlrd.XL_CELL_BOLEAN xlrd.XL_CELL_EMPTY</span></span><br><span class="line">cell = sheet.cell(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(cell))</span><br><span class="line"><span class="built_in">print</span>(cell.ctype) <span class="comment"># 1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span> * <span class="number">30</span>)</span><br><span class="line">values = sheet.col_values(<span class="number">2</span>, <span class="number">1</span>, sheet.nrows)</span><br><span class="line"><span class="built_in">print</span>(values)</span><br></pre></td></tr></table></figure>
<h2 id="使用xlwt模块写入excel数据"><a href="#使用xlwt模块写入excel数据" class="headerlink" title="使用xlwt模块写入excel数据"></a>使用xlwt模块写入excel数据</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导入xlwt模块，创建workbook对象，创建sheet对象，sheet.write方法写入，最后save保存</span></span><br><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment"># 创建workbook</span></span><br><span class="line">workbook = xlwt.Workbook()</span><br><span class="line"><span class="comment"># 创建表</span></span><br><span class="line">sheet = workbook.add_sheet(<span class="string">&quot;sheet1&quot;</span>)</span><br><span class="line"><span class="comment"># 写入行头部</span></span><br><span class="line">headers = [<span class="string">&#x27;姓名&#x27;</span>,<span class="string">&#x27;语文&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> index, header <span class="keyword">in</span> <span class="built_in">enumerate</span>(headers):</span><br><span class="line">    sheet.write(<span class="number">0</span>, index, header)</span><br><span class="line"><span class="comment"># 写入列头部</span></span><br><span class="line">names = [<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> index, name <span class="keyword">in</span> <span class="built_in">enumerate</span>(names):</span><br><span class="line">    sheet.write(index+<span class="number">1</span>, <span class="number">0</span>, name)</span><br><span class="line"><span class="comment"># 循环填入表数据</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        sheet.write(row, col, random.randint(<span class="number">1</span>, <span class="number">101</span>))</span><br><span class="line">workbook.save(<span class="string">&#x27;成绩表.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="使用xlwt模块编辑excel文件"><a href="#使用xlwt模块编辑excel文件" class="headerlink" title="使用xlwt模块编辑excel文件"></a>使用xlwt模块编辑excel文件</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwt,xlrd</span><br><span class="line"><span class="comment"># 读取某张表,</span></span><br><span class="line">rwk = xlrd.open_workbook(<span class="string">&#x27;成绩表.xls&#x27;</span>)</span><br><span class="line"><span class="comment"># 选取sheet</span></span><br><span class="line">rsheet = rwk.sheet_by_index(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 添加某一项</span></span><br><span class="line">rsheet.put_cell(<span class="number">0</span>, <span class="number">4</span>, xlrd.XL_CELL_TEXT, <span class="string">&quot;总分&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">nrows = rsheet.nrows</span><br><span class="line">ncols = rsheet.ncols</span><br><span class="line"><span class="built_in">print</span>(nrows, ncols)</span><br><span class="line"><span class="comment"># 获取某行某几列的值</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, nrows):</span><br><span class="line">    grade = rsheet.row_values(row, <span class="number">1</span>, ncols)</span><br><span class="line">    <span class="comment"># print(grade)</span></span><br><span class="line">    total = <span class="built_in">sum</span>(grade)</span><br><span class="line">    <span class="comment"># print(total)</span></span><br><span class="line">    rsheet.put_cell(row, <span class="number">4</span>, xlrd.XL_CELL_NUMBER, total, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求平均分</span></span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ncols):</span><br><span class="line">    grade = rsheet.col_values(col, <span class="number">1</span>, nrows)</span><br><span class="line">    avg = <span class="built_in">sum</span>(grade)/<span class="built_in">len</span>(grade)</span><br><span class="line">    <span class="built_in">print</span>(avg)</span><br><span class="line">    rsheet.put_cell(nrows, col, xlrd.XL_CELL_NUMBER, avg, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写到某个表中</span></span><br><span class="line">wwk = xlwt.Workbook()</span><br><span class="line">wsheet = wwk.add_sheet(<span class="string">&#x27;sheet1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加数据</span></span><br><span class="line"><span class="comment"># 因为添加的平均分这一行，所以得重新获取行数</span></span><br><span class="line">nrows = rsheet.nrows</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, nrows):</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, ncols):</span><br><span class="line">        wsheet.write(row, col, rsheet.cell_value(row, col))</span><br><span class="line"><span class="comment"># 保存表</span></span><br><span class="line">wwk.save(<span class="string">&#x27;abc.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>python</category>
        <category>python爬虫</category>
      </categories>
      <tags>
        <tag>Execel</tag>
        <tag>CSV</tag>
      </tags>
  </entry>
  <entry>
    <title>pyhon生成器</title>
    <url>/pyhon%E7%94%9F%E6%88%90%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2>]]></content>
      <categories>
        <category>python</category>
      </categories>
  </entry>
  <entry>
    <title>python装饰器</title>
    <url>/python%E8%A3%85%E9%A5%B0%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>使用python装饰器，可以在不改变原来函数代码的前提下，给函数增加新的功能。可以给函数增加日志，增加权限。</p>
<span id="more"></span>

<h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><ul>
<li>函数里面嵌套函数</li>
<li>外层函数返回内层函数的名字</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun1</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;fun1&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fun2</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;fun2&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> fun2</span><br><span class="line"><span class="comment"># fun1() = fun2 如果想调用fun2，可以fun1()(),隐藏了内层函数的名字。</span></span><br></pre></td></tr></table></figure>

<h2 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h2><ul>
<li>被装饰函数作为参数传递给装饰器函数</li>
<li>被装饰函数作为装饰函数的返回值。</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 装饰器函数fn</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>(<span class="params">f</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line">        f(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> inner </span><br><span class="line"><span class="comment"># 被装饰函数带参数</span></span><br><span class="line"><span class="meta">@fn</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun1</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> a+b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 装饰器函数带参数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>(<span class="params">args</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">w</span>(<span class="params">f</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">            <span class="keyword">if</span> args == <span class="number">1</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;验证1&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">            	<span class="built_in">print</span>(<span class="string">&#x27;验证2&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;inner函数&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> inner</span><br><span class="line">    <span class="keyword">return</span> w</span><br><span class="line"><span class="meta">@fn(<span class="params"><span class="number">1</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun2</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;fun2&#x27;</span>)</span><br><span class="line"><span class="meta">@fn(<span class="params"><span class="number">2</span></span>)    </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun3</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;fun3&#x27;</span>)</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>python</category>
      </categories>
  </entry>
  <entry>
    <title>urllib和requests库的使用</title>
    <url>/urllib%E5%92%8Crequests%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>urllib是python的基本库之一，内置四大模块，即request，error，parse，response，robotparser，常用的request，error，一个用于发送HTTP请求，一个用于处理请求的错误。parse用于对URL的处理，拆分，全并等。</p>
<span id="more"></span>

<h2 id="urllib库-—内置（request，parse）"><a href="#urllib库-—内置（request，parse）" class="headerlink" title="urllib库 —内置（request，parse）"></a>urllib库 —内置（request，parse）</h2><h3 id="request–-gt-urlopen函数"><a href="#request–-gt-urlopen函数" class="headerlink" title="request–&gt;urlopen函数"></a>request–&gt;urlopen函数</h3><p>urlopen()函数<br>url 请求的url<br>data 参数，加上data，变为post请求<br>返回值 返回一个对象，有read，read(size),readline,readlines,getcode等方法。<br>read()返回为字节类的字符串。</p>
<h3 id="request–-gt-urlretrieve函数"><a href="#request–-gt-urlretrieve函数" class="headerlink" title="request–&gt;urlretrieve函数"></a>request–&gt;urlretrieve函数</h3><p>将网页上的文件保存到本地</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line">request.urlretrieve(url,文件名)</span><br></pre></td></tr></table></figure>
<h3 id="request–-gt-Request类"><a href="#request–-gt-Request类" class="headerlink" title="request–&gt;Request类"></a>request–&gt;Request类</h3><blockquote>
<p>通过Request类增加请求头信息。</p>
</blockquote>
<h3 id="parse—-gt-urlencode函数-编码"><a href="#parse—-gt-urlencode函数-编码" class="headerlink" title="parse—&gt;urlencode函数 编码"></a>parse—&gt;urlencode函数 编码</h3><p>把字典转换为url编码的数据。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">18</span>,<span class="string">&#x27;greet&#x27;</span>:<span class="string">&#x27;hello world&#x27;</span>&#125;</span><br><span class="line">qs = parse.urlencode(data)</span><br><span class="line"><span class="built_in">print</span>(qs) <span class="comment"># name=%E5%BC%A0%E4%B8%89&amp;age=18&amp;greet=hello+world</span></span><br><span class="line"><span class="comment"># quote函数</span></span><br><span class="line">s1 = parse.quote(s)</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br></pre></td></tr></table></figure>
<h3 id="parse—-gt-parse-qs函数-解码"><a href="#parse—-gt-parse-qs函数-解码" class="headerlink" title="parse—&gt;parse_qs函数  解码"></a>parse—&gt;parse_qs函数  解码</h3><p>对经过url编码的数据进行解码。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">dict</span> = parse.parse_qs(qs)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">dict</span>) <span class="comment"># &#123;&#x27;name&#x27;: [&#x27;张三&#x27;], &#x27;age&#x27;: [&#x27;18&#x27;], &#x27;greet&#x27;: [&#x27;hello world&#x27;]&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="parse—-gt-urlparse和urlsplit函数"><a href="#parse—-gt-urlparse和urlsplit函数" class="headerlink" title="parse—&gt;urlparse和urlsplit函数"></a>parse—&gt;urlparse和urlsplit函数</h3><p>这两个函数都是用来解析url的，不同的是urlsplit解析出来的url没有params参数。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://www.baidu.com/index.html;user?id=S#comment&#x27;</span></span><br><span class="line"></span><br><span class="line">result = parse.urlparse(url)</span><br><span class="line"><span class="comment"># result = parse.urlsplit(url)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">print</span>(result.scheme)</span><br><span class="line"><span class="built_in">print</span>(result.netloc)</span><br><span class="line"><span class="built_in">print</span>(result.path)</span><br><span class="line"><span class="comment">#urlparse里有params属性，而urlsplit没有这个params属性。</span></span><br><span class="line"><span class="built_in">print</span>(result.params)</span><br></pre></td></tr></table></figure>

<h3 id="ProxyHandler处理器（代理设置）：封ip问题"><a href="#ProxyHandler处理器（代理设置）：封ip问题" class="headerlink" title="ProxyHandler处理器（代理设置）：封ip问题"></a>ProxyHandler处理器（代理设置）：封ip问题</h3><ol>
<li><p>代理原理：在请求目的网站之前，先请求代理服务器，然后让代理服务器去请求目的网站，代理服务器拿到目的网站的数据后，再转发给我们的代码。</p>
</li>
<li><p><a href="http://httpbin.org：这个网站可以方便的查看http请求的一些参数。">http://httpbin.org：这个网站可以方便的查看http请求的一些参数。</a></p>
</li>
<li><p>在代码中使用代理  示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用代理</span></span><br><span class="line"><span class="comment"># 步骤</span></span><br><span class="line">url = <span class="string">&#x27;http://httpbin.org/ip&#x27;</span></span><br><span class="line"><span class="comment">#1. 使用ProxyHandler,传入代理构建一个handler</span></span><br><span class="line">handler = request.ProxyHandler(&#123;<span class="string">&#x27;http&#x27;</span>:<span class="string">&#x27;122.193.244.243:9999&#x27;</span>&#125;)</span><br><span class="line"><span class="comment">#2. 使用上面创建的handler构建一个opener</span></span><br><span class="line">opener = request.build_opener(handler)</span><br><span class="line"><span class="comment">#3. 使用opener去发送一个请求</span></span><br><span class="line">resp = opener.<span class="built_in">open</span>(url)</span><br><span class="line"><span class="built_in">print</span>(resp.read())</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="http-cookiejar模块：提供用于存储cookie的对象"><a href="#http-cookiejar模块：提供用于存储cookie的对象" class="headerlink" title="http.cookiejar模块：提供用于存储cookie的对象"></a>http.cookiejar模块：提供用于存储cookie的对象</h3><ol>
<li><p>CookieJar：管理HTTP cookie值、存储HTTP请求生成的cookie、向传出的HTTP请求添加cookie的对象。整个cookie都存储在内存中，对CookieJar实例进行垃圾回收后cookie也将丢失。</p>
</li>
<li><p>FileCookieJar (filename,delayload=None,policy=None)：从CookieJar派生而来，用来创建FileCookieJar实例，检索cookie信息并将cookie存储到文件中。filename是存储cookie的文件名。delayload为True时支持延迟访问访问文件，即只有在需要时才读取文件或在文件中存储数据。</p>
</li>
<li><p>MozillaCookieJar (filename,delayload=None,policy=None)：从FileCookieJar派生而来，创建与Mozilla浏览器 cookies.txt兼容的FileCookieJar实例。</p>
</li>
<li><p>LWPCookieJar (filename,delayload=None,policy=None)：从FileCookieJar派生而来，创建与libwww-perl标准的 Set-Cookie3 文件格式兼容的FileCookieJar实例。</p>
</li>
</ol>
<p>实例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> http.cookiejar <span class="keyword">import</span>  CookieJar</span><br><span class="line"></span><br><span class="line"><span class="comment"># 登录：https://i.meishi.cc/login.php?redirect=https%3A%2F%2Fwww.meishij.net%2F</span></span><br><span class="line"><span class="comment">#个人网页https://i.meishi.cc/cook.php?id=13686422</span></span><br><span class="line"></span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#1.登录</span></span><br><span class="line"><span class="comment">#1.1 创建cookiejar对象</span></span><br><span class="line">cookiejar = CookieJar()</span><br><span class="line"><span class="comment">#1.2 使用cookiejar创建一个HTTPCookieProcess对象</span></span><br><span class="line">handler = request.HTTPCookieProcessor(cookiejar)</span><br><span class="line"><span class="comment">#1.3 使用上一步的创建的handler创建一个opener</span></span><br><span class="line">opener = request.build_opener(handler)</span><br><span class="line"><span class="comment">#1.4 使用opener发送登录请求  (账号和密码)</span></span><br><span class="line"></span><br><span class="line">post_url = <span class="string">&#x27;https://i.meishi.cc/login.php?redirect=https%3A%2F%2Fwww.meishij.net%2F&#x27;</span></span><br><span class="line">post_data = parse.urlencode(&#123;</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;1097566154@qq.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;wq15290884759.&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line">req = request.Request(post_url,data=post_data.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">opener.<span class="built_in">open</span>(req)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.访问个人网页</span></span><br><span class="line">url = <span class="string">&#x27;https://i.meishi.cc/cook.php?id=13686422&#x27;</span></span><br><span class="line">rq = request.Request(url,headers=headers)</span><br><span class="line">resp = opener.<span class="built_in">open</span>(rq)</span><br><span class="line"><span class="built_in">print</span>(resp.read().decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>cookie加载与保存</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> http.cookiejar <span class="keyword">import</span> MozillaCookieJar</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存</span></span><br><span class="line"><span class="comment"># cookiejar = MozillaCookieJar(&#x27;cookie.txt&#x27;)</span></span><br><span class="line"><span class="comment"># handler = request.HTTPCookieProcessor(cookiejar)</span></span><br><span class="line"><span class="comment"># opener = request.build_opener(handler)</span></span><br><span class="line"><span class="comment"># resp = opener.open(&#x27;http://www.httpbin.org/cookies/set/course/abc&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># cookiejar.save(ignore_discard=True,ignore_expires=True)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ignore_discard=True  即使cookies即将被丢弃也要保存下来</span></span><br><span class="line"><span class="comment"># ignore_expires=True  如果cookies已经过期也将它保存并且文件已存在时将覆盖</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#加载</span></span><br><span class="line"></span><br><span class="line">cookiejar = MozillaCookieJar(<span class="string">&#x27;cookie.txt&#x27;</span>)</span><br><span class="line">cookiejar.load()</span><br><span class="line">handler = request.HTTPCookieProcessor(cookiejar)</span><br><span class="line">opener = request.build_opener(handler)</span><br><span class="line">resp = opener.<span class="built_in">open</span>(<span class="string">&#x27;http://www.httpbin.org/cookies/set/course/abc&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> cookie <span class="keyword">in</span> cookiejar:</span><br><span class="line">    <span class="built_in">print</span>(cookie)</span><br></pre></td></tr></table></figure>

<h2 id="requests-—第三方库"><a href="#requests-—第三方库" class="headerlink" title="requests —第三方库"></a>requests —第三方库</h2><h3 id="requests-get"><a href="#requests-get" class="headerlink" title="requests.get"></a>requests.get</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">url = <span class="string">&#x27;http://www.baidu.com&#x27;</span></span><br><span class="line">resp = requests.get(url)</span><br><span class="line"><span class="built_in">print</span>(resp.text) <span class="comment"># 字符串</span></span><br><span class="line"><span class="built_in">print</span>(resp.content) <span class="comment"># 字节类型</span></span><br><span class="line"><span class="built_in">print</span>(resp.content.decode())<span class="comment"># 字节类型转换为字符串</span></span><br><span class="line"><span class="comment"># 文件内容 r，w，a，（r，rb，r+，rb+）</span></span><br></pre></td></tr></table></figure>

<h4 id="response-text和response-content的区别："><a href="#response-text和response-content的区别：" class="headerlink" title="response.text和response.content的区别："></a>response.text和response.content的区别：</h4><ol>
<li><code>response.content</code> ：这个是直接从网络上抓取的数据，没有经过任何的编码，所以是一个bytes类型，其实在硬盘上和网络上传输的字符串都是bytes类型</li>
<li><code>response.text</code>：这个是str的数据类型，是requests库将response.content进行解码的字符串，解码需要指定一个编码方式，requests会根据自己的猜测来判断编码的方式，所以有时候可能会猜测错误，就会导致解码产生乱码，这时候就应该进行手动解码，比如使用<code>response.content.decode(&#39;utf-8&#39;)</code></li>
</ol>
<h3 id="发送POST请求："><a href="#发送POST请求：" class="headerlink" title="发送POST请求："></a>发送POST请求：</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">response = requests.post(<span class="string">&quot;http://www.baidu.com/&quot;</span>,data=data)</span><br></pre></td></tr></table></figure>

<h3 id="使用代理："><a href="#使用代理：" class="headerlink" title="使用代理："></a>使用代理：</h3><p>只要在请求的方法中（比如get或者post）传递proxies参数就可以了。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">proxy = &#123;</span><br><span class="line">    <span class="string">&#x27;http&#x27;</span>:<span class="string">&#x27;111.77.197.127:9999&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">url = <span class="string">&#x27;http://www.httpbin.org/ip&#x27;</span></span><br><span class="line">resp = requests.get(url,proxies=proxy)</span><br><span class="line"><span class="built_in">print</span>(resp.text)</span><br></pre></td></tr></table></figure>

<h4 id="session：共享cookie"><a href="#session：共享cookie" class="headerlink" title="session：共享cookie"></a>session：共享cookie</h4><p>案例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">post_url = <span class="string">&#x27;https://i.meishi.cc/login.php?redirect=https%3A%2F%2Fwww.meishij.net%2F&#x27;</span></span><br><span class="line"></span><br><span class="line">post_data = &#123;</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;1097566154@qq.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;wq15290884759.&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 登录</span></span><br><span class="line">session = requests.session()</span><br><span class="line">session.post(post_url,headers=headers,data=post_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#访问个人网页</span></span><br><span class="line">url = <span class="string">&#x27;https://i.meishi.cc/cook.php?id=13686422&#x27;</span></span><br><span class="line"></span><br><span class="line">resp = session.get(url)</span><br><span class="line"><span class="built_in">print</span>(resp.text)</span><br></pre></td></tr></table></figure>

<h3 id="处理不信任的SSL证书："><a href="#处理不信任的SSL证书：" class="headerlink" title="处理不信任的SSL证书："></a>处理不信任的SSL证书：</h3><p>对于那些已经被信任的SSL证书的网站，比如<a href="https://www.baidu.com/%EF%BC%8C%E9%82%A3%E4%B9%88%E4%BD%BF%E7%94%A8requests%E7%9B%B4%E6%8E%A5%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%AD%A3%E5%B8%B8%E7%9A%84%E8%BF%94%E5%9B%9E%E5%93%8D%E5%BA%94%E3%80%82%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%9A">https://www.baidu.com/，那么使用requests直接就可以正常的返回响应。示例代码如下：</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">resp = requests.get(<span class="string">&#x27;https://inv-veri.chinatax.gov.cn/&#x27;</span>,verify=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(resp.content.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>python</category>
        <category>python爬虫</category>
      </categories>
      <tags>
        <tag>urllib和requests</tag>
      </tags>
  </entry>
  <entry>
    <title>pip设置永久国内镜像源</title>
    <url>/pip%E8%AE%BE%E7%BD%AE%E6%B0%B8%E4%B9%85%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E6%BA%90/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1-创建pip文件"><a href="#1-创建pip文件" class="headerlink" title="1. 创建pip文件"></a>1. 创建pip文件</h2><ul>
<li><strong>win+r</strong>，输入 <strong>%appdata%</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C:\Users\dell\AppData\Roaming</span><br></pre></td></tr></table></figure>

<ul>
<li>新建pip文件夹</li>
<li>在文件夹中编辑pip.ini文件</li>
</ul>
<h2 id="2-编辑pip-ini文件，保存"><a href="#2-编辑pip-ini文件，保存" class="headerlink" title="2. 编辑pip.ini文件，保存"></a>2. 编辑pip.ini文件，保存</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[<span class="keyword">global</span>]</span><br><span class="line">timeout = <span class="number">6000</span></span><br><span class="line">index_url = https://pypi.doubanio.com/simple</span><br><span class="line">trusted-host = pypi.doubanio.com</span><br></pre></td></tr></table></figure>

<h2 id="3-更改mkvirtualenv生成虚拟环境目录"><a href="#3-更改mkvirtualenv生成虚拟环境目录" class="headerlink" title="3. 更改mkvirtualenv生成虚拟环境目录"></a>3. 更改mkvirtualenv生成虚拟环境目录</h2><ul>
<li>在环境变量中编辑<strong>WORKON_HOME</strong>变量</li>
<li>设置自己虚拟环境的生成目录</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\Program Files\Virtualenv</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>pip</tag>
      </tags>
  </entry>
  <entry>
    <title>django框架</title>
    <url>/django%E6%A1%86%E6%9E%B6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>框架的学习，可以让我们更便捷的开发一个网站。目前，python框架使用最多的是Django框架和Flask框架。</p>
<span id="more"></span>

<h2 id="Django框架"><a href="#Django框架" class="headerlink" title="Django框架"></a>Django框架</h2><h3 id="Django框架的特点"><a href="#Django框架的特点" class="headerlink" title="Django框架的特点"></a>Django框架的特点</h3><ol>
<li>创建一个应用</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">django-admin startproject dgj</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建子应用并注册</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manager.py startapp users</span><br><span class="line"></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&#x27;django.contrib.admin&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.auth&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.contenttypes&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.sessions&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.messages&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.staticfiles&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dzy.apps.DzyConfig&#x27;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>在视图下编辑业务代码，并注册路由</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> dzy.views <span class="keyword">import</span> index</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&#x27;index/&#x27;</span>, index),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>时区、语言的配置</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">LANGUAGE_CODE = <span class="string">&#x27;zh-hans&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># TIME_ZONE = &#x27;UTC&#x27;</span></span><br><span class="line">TIME_ZONE = <span class="string">&#x27;Asia/Shanghai&#x27;</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>静态文件的配置</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">STATIC_URL = <span class="string">&#x27;/static/&#x27;</span></span><br><span class="line"><span class="comment"># 静态文件的位置</span></span><br><span class="line">STATICFILES_DIRS = [</span><br><span class="line">    os.path.join(BASE_DIR, <span class="string">&#x27;static_files&#x27;</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>路由的配置</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在路由配置里面，增加函数视图，增加类视图，增加应用配置视图</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&#x27;dzy/&#x27;</span>, include(<span class="string">&#x27;dzy.urls&#x27;</span>))</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>请求和响应</li>
</ol>
<ul>
<li>url请求参数</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>提取url特定部分，比如/weather/beijing/<span class="number">2021</span> <span class="string">r&#x27;^weather/(?P&lt;city&gt;[a-z]+)/(?P&lt;year&gt;\d&#123;4&#125;)/$&#x27;</span></span><br><span class="line"><span class="number">2.</span>查询字符串(query string),key1=value1&amp;key2=value2 request.method</span><br><span class="line"><span class="number">3.</span>请求体(body)中数据，json, request.body</span><br><span class="line"><span class="number">4.</span>http中报文头(header),User-Agent,Referer request.META</span><br></pre></td></tr></table></figure>

<ul>
<li>HttpResponse</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">json_view</span>(<span class="params">request</span>):</span></span><br><span class="line">    json_str = &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;dgj&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">20</span>,<span class="string">&quot;class&quot;</span>:<span class="string">&quot;django2009&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># redirect()</span></span><br><span class="line">    <span class="keyword">return</span> JsonResponse(json_str)</span><br></pre></td></tr></table></figure>

<ol start="8">
<li>cookie和session</li>
</ol>
<ul>
<li>cookie</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cookieview</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    res = HttpResponse(<span class="string">&#x27;OK&#x27;</span>)</span><br><span class="line">    res.set_cookie(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;dgj&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">readcookie</span>(<span class="params">request</span>):</span></span><br><span class="line">    name = request.COOKIES.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(name)</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;读取成功&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>session</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setsession</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    request.session[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;dgj&#x27;</span></span><br><span class="line">    request.session[<span class="string">&#x27;age&#x27;</span>] = <span class="number">20</span></span><br><span class="line">    <span class="comment"># 设置session保存时间</span></span><br><span class="line">    request.session.set_expiry(<span class="number">120</span>)</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;OK&quot;</span>)</span><br></pre></td></tr></table></figure>

<ol start="9">
<li>类视图和中间件</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 请求之前，响应之后</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">simple_middleware</span>(<span class="params">get_response</span>):</span></span><br><span class="line">    <span class="comment"># 此处编写的代码仅在Django第一次配置和初始化的时候执行一次。</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">middleware</span>(<span class="params">request</span>):</span></span><br><span class="line">        <span class="comment"># 此处编写的代码会在每个请求处理视图前被调用。</span></span><br><span class="line"></span><br><span class="line">        response = get_response(request)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 此处编写的代码会在每个请求处理视图之后被调用。</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> middleware</span><br></pre></td></tr></table></figure>

<ol start="10">
<li>文件上传</li>
</ol>
<p>在模板中 创建一个form表单 需要特别注意的是，在有文件上传的表单中，method的属性必须是post 而且必须指定他的enctype为“multipart/form-data” 表明不对字符进行编码，具体的代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;form action=&quot;/upload/&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    文件上传：&lt;input type=&quot;file&quot; name=&quot;files&quot; class=&quot;file_up&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;上传&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>.read() 从文件读取整个上传的数据，这个方法只适合小文件</p>
<p>chunks() 按块返回文件，通过在for循环中进行迭代，可以将大文件按块写入到服务器中</p>
<p>multiple_chunks() 这个方法根据文件对象的大小，返回True或者False当文件大于2.5M(默认为2.5M，可以调整)时，该方法返回True,否则返回False因此可以根据该方法来选择选用read方法读取还是采用chunks方法。</p>
<p>文件对象.name 这是个属性 不是方法 该属性得到上传的文件名 包括后缀如weizi.py</p>
<p>文件对象.size 这个也是个属性，得到上传文件的大小。</p>
<ol start="11">
<li>template</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 模板渲染</span></span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    context=&#123;<span class="string">&#x27;city&#x27;</span>: <span class="string">&#x27;北京&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">&#x27;index.html&#x27;</span>,context)</span><br></pre></td></tr></table></figure>

<ol start="12">
<li>数据库</li>
</ol>
<ul>
<li>关联查询，一对多</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> book.models <span class="keyword">import</span> BookInfo,HeroInfo</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = BookInfo.objects.get(<span class="built_in">id</span>=<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line">&lt;BookInfo: 天龙八部&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b.heroinfo_set.<span class="built_in">all</span>()</span><br><span class="line">&lt;QuerySet [&lt;HeroInfo: 乔峰&gt;, &lt;HeroInfo: 段誉&gt;, &lt;HeroInfo: 虚竹&gt;, &lt;HeroInfo: 王语嫣&gt;]&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>多对一的查询，直接查询外键</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>h = HeroInfo.objects.get(<span class="built_in">id</span>=<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>h</span><br><span class="line">&lt;HeroInfo: 黄蓉&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>h.hbook</span><br><span class="line">&lt;BookInfo: 射雕英雄传&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>修改数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 对象修改，需要使用save方法保存</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>h = HeroInfo.objects.get(pk=<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>h</span><br><span class="line">&lt;HeroInfo: 黄蓉&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>h.hname = <span class="string">&#x27;蓉妹妹&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>h.save()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 类对象修改，精确查找没有update方法，使用filter</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> book.models <span class="keyword">import</span> BookInfo,HeroInfo</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>HeroInfo.objects.get(<span class="built_in">id</span>=<span class="number">2</span>).update(hname=<span class="string">&#x27;黄蓉&#x27;</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;console&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">&#x27;HeroInfo&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;update&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>HeroInfo.objects.<span class="built_in">filter</span>(<span class="built_in">id</span>=<span class="number">2</span>).update(hname=<span class="string">&#x27;黄蓉&#x27;</span>)</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在视图里进行orm操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    book_list = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        book_query = BookInfo.objects.<span class="built_in">all</span>()</span><br><span class="line">        <span class="built_in">print</span>(book_query)</span><br><span class="line">        <span class="keyword">for</span> book <span class="keyword">in</span> book_query:</span><br><span class="line">            book_dict = &#123;&#125;</span><br><span class="line">            book_dict[<span class="string">&#x27;title&#x27;</span>] = book.btitle</span><br><span class="line">            book_dict[<span class="string">&#x27;bpub_date&#x27;</span>] = book.bpub_date</span><br><span class="line">            book_list.append(book_dict)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">    <span class="built_in">print</span>(book_list)</span><br><span class="line">    <span class="keyword">return</span> JsonResponse(book_list, safe=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>python</category>
        <category>python框架</category>
        <category>django框架</category>
      </categories>
      <tags>
        <tag>django</tag>
      </tags>
  </entry>
  <entry>
    <title>django下admin站点</title>
    <url>/django%E4%B8%8Badmin%E7%AB%99%E7%82%B9/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>django自带admin站点。</p>
<span id="more"></span>

<h2 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manager.py createsuperuser</span><br></pre></td></tr></table></figure>

<h2 id="在admin-py下进行配置"><a href="#在admin-py下进行配置" class="headerlink" title="在admin.py下进行配置"></a>在admin.py下进行配置</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 注册后台数据模型的两种方式</span></span><br><span class="line"><span class="keyword">from</span> book.models <span class="keyword">import</span> BookInfo, HeroInfo</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    list_display = [<span class="string">&#x27;btitle&#x27;</span>,<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;bread&#x27;</span>,<span class="string">&#x27;bpub_date&#x27;</span>,<span class="string">&#x27;is_delete&#x27;</span>] <span class="comment"># 数据列展示</span></span><br><span class="line">    actions_on_bottom = <span class="literal">True</span></span><br><span class="line">    actions_on_top = <span class="literal">False</span> <span class="comment"># 设置表操作方式</span></span><br><span class="line">    fields = [<span class="string">&#x27;btitle&#x27;</span>, <span class="string">&#x27;bread&#x27;</span>,<span class="string">&#x27;bpub_date&#x27;</span>]<span class="comment"># 数据编辑显示</span></span><br><span class="line">    fieldsets = (</span><br><span class="line">        (<span class="string">&#x27;基本&#x27;</span>, &#123;<span class="string">&#x27;fields&#x27;</span>: [<span class="string">&#x27;btitle&#x27;</span>, <span class="string">&#x27;bpub_date&#x27;</span>]&#125;),</span><br><span class="line">        (<span class="string">&#x27;高级&#x27;</span>, &#123;</span><br><span class="line">            <span class="string">&#x27;fields&#x27;</span>: [<span class="string">&#x27;bread&#x27;</span>, <span class="string">&#x27;bcomment&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;classes&#x27;</span>: (<span class="string">&#x27;collapse&#x27;</span>,)  <span class="comment"># 是否折叠显示</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(<span class="params">HeroInfo</span>)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeroInfoAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    list_display = [<span class="string">&#x27;hbook&#x27;</span>,<span class="string">&#x27;hname&#x27;</span>,<span class="string">&#x27;hgender&#x27;</span>,<span class="string">&#x27;hcomment&#x27;</span>,<span class="string">&#x27;is_delete&#x27;</span>]</span><br><span class="line">    list_per_page = <span class="number">5</span> <span class="comment"># 设置分页</span></span><br><span class="line"></span><br><span class="line">admin.site.register(BookInfo, BookInfoAdmin)</span><br><span class="line"><span class="comment"># admin.site.register(HeroInfo, HeroInfoAdmin)</span></span><br></pre></td></tr></table></figure>

<h2 id="关联对象，一对多下的数据展示页面"><a href="#关联对象，一对多下的数据展示页面" class="headerlink" title="关联对象，一对多下的数据展示页面"></a>关联对象，一对多下的数据展示页面</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeroInfoStackInline</span>(<span class="params">admin.StackedInline</span>):</span></span><br><span class="line">    <span class="comment"># 块展示</span></span><br><span class="line">    model = HeroInfo  <span class="comment"># 要编辑的对象</span></span><br><span class="line">    extra = <span class="number">1</span>  <span class="comment"># 附加编辑的数量</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeroInfoTabularInline</span>(<span class="params">admin.TabularInline</span>):</span></span><br><span class="line">    <span class="comment"># 表格展示</span></span><br><span class="line">    model = HeroInfo</span><br><span class="line">    extra = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    ...</span><br><span class="line">    inlines = [HeroInfoStackInline]<span class="comment">#调用</span></span><br></pre></td></tr></table></figure>

<h2 id="设置站点信息的展示"><a href="#设置站点信息的展示" class="headerlink" title="设置站点信息的展示"></a>设置站点信息的展示</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">admin.site.site_header 设置网站页头</span><br><span class="line">admin.site.site_title 设置页面标题</span><br><span class="line">admin.site.index_title 设置首页标语</span><br></pre></td></tr></table></figure>

<h2 id="上传图片"><a href="#上传图片" class="headerlink" title="上传图片"></a>上传图片</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfo</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    ...</span><br><span class="line">    image = models.ImageField(upload_to=<span class="string">&#x27;books&#x27;</span>, verbose_name=<span class="string">&#x27;图片封面&#x27;</span>, null=<span class="literal">True</span>,blank=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>python</category>
        <category>python框架</category>
        <category>django框架</category>
      </categories>
      <tags>
        <tag>django</tag>
      </tags>
  </entry>
  <entry>
    <title>django中drf使用</title>
    <url>/django%E4%B8%ADdrf%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>通过drf框架写一个用户注册的示例</p>
<span id="more"></span>

<h2 id="建立用户数据模型"><a href="#建立用户数据模型" class="headerlink" title="建立用户数据模型"></a>建立用户数据模型</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    mobile = models.CharField(max_length=<span class="number">11</span>, verbose_name=<span class="string">&#x27;手机&#x27;</span>,unique=<span class="literal">True</span>)</span><br><span class="line">    password = models.CharField(verbose_name=<span class="string">&#x27;密码&#x27;</span>, max_length=<span class="number">11</span>)</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">&#x27;tb_users&#x27;</span></span><br><span class="line">        verbose_name = <span class="string">&#x27;用户表&#x27;</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br></pre></td></tr></table></figure>

<h2 id="创建视图模型"><a href="#创建视图模型" class="headerlink" title="创建视图模型"></a>创建视图模型</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegView</span>(<span class="params">CreateAPIView, ListAPIView</span>):</span></span><br><span class="line">    serializer_class = UserInfoSerializer</span><br><span class="line">    queryset = UserInfo.objects.<span class="built_in">all</span>()</span><br></pre></td></tr></table></figure>

<h2 id="建立路由"><a href="#建立路由" class="headerlink" title="建立路由"></a>建立路由</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># re_path(r&#x27;^$&#x27;, views.index),</span></span><br><span class="line">    re_path(<span class="string">r&#x27;^reg/$&#x27;</span>, views.RegView.as_view()),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h2 id="在视图模型中引入drf框架，引入序列化类，并做数据验证"><a href="#在视图模型中引入drf框架，引入序列化类，并做数据验证" class="headerlink" title="在视图模型中引入drf框架，引入序列化类，并做数据验证"></a>在视图模型中引入drf框架，引入序列化类，并做数据验证</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoSerializer</span>(<span class="params">serializers.ModelSerializer</span>):</span></span><br><span class="line">    password2 = serializers.CharField(label=<span class="string">&quot;重复密码&quot;</span>, max_length=<span class="number">11</span>, write_only=<span class="literal">True</span>)</span><br><span class="line">    password = serializers.CharField(label=<span class="string">&quot;密码&quot;</span>, max_length=<span class="number">11</span>, write_only=<span class="literal">True</span>)</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = UserInfo</span><br><span class="line">        fields = (<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;mobile&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,<span class="string">&#x27;password2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate_mobile</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> re.match(<span class="string">r&#x27;^1[3-9]\d&#123;9&#125;$&#x27;</span>, value):</span><br><span class="line">            <span class="built_in">print</span>(value)</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">&#x27;手机号码不对&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(data)</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;password2&#x27;</span>] != data[<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">&#x27;两次输入密码不一致&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">self, validated_data</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(validated_data)</span><br><span class="line">        <span class="keyword">del</span> validated_data[<span class="string">&#x27;password2&#x27;</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;----------------&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(validated_data)</span><br><span class="line">        user = UserInfo.objects.create(**validated_data)</span><br><span class="line">        <span class="keyword">return</span> user</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>python</category>
        <category>python框架</category>
        <category>django</category>
      </categories>
      <tags>
        <tag>django</tag>
      </tags>
  </entry>
  <entry>
    <title>bs4</title>
    <url>/bs4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>和 lxml 一样，Beautiful Soup 也是一个HTML/XML的解析器，主要的功能也是如何解析和提取 HTML/XML 数据。</p>
<span id="more"></span>

<h2 id="安装和文档："><a href="#安装和文档：" class="headerlink" title="安装和文档："></a>安装和文档：</h2><p>安装：<br>pip install bs4</p>
<p>中文文档：<a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html">https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html</a></p>
<h2 id="几大解析工具对比："><a href="#几大解析工具对比：" class="headerlink" title="几大解析工具对比："></a>几大解析工具对比：</h2><h2 id="简单使用："><a href="#简单使用：" class="headerlink" title="简单使用："></a>简单使用：</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">html = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse&#x27;s story&lt;/title&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;p class=&quot;title&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse&#x27;s story&lt;/b&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;p class=&quot;story&quot;&gt;Once upon a time there were three little sisters; and their names were</span></span><br><span class="line"><span class="string">&lt;a href=&quot;http://example.com/elsie&quot; class=&quot;sister&quot; id=&quot;link1&quot;&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,</span></span><br><span class="line"><span class="string">&lt;a href=&quot;http://example.com/lacie&quot; class=&quot;sister&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and</span></span><br><span class="line"><span class="string">&lt;a href=&quot;http://example.com/tillie&quot; class=&quot;sister&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;;</span></span><br><span class="line"><span class="string">and they lived at the bottom of a well.&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;p class=&quot;story&quot;&gt;...&lt;/p&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">soup = BeautifulSoup(html,<span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(soup.prettify())</span><br></pre></td></tr></table></figure>

<h2 id="常见的四种对象："><a href="#常见的四种对象：" class="headerlink" title="常见的四种对象："></a>常见的四种对象：</h2><ol>
<li>Tag：BeautifulSoup中所有的标签都是Tag类型，并且BeautifulSoup的对象其实本质上也是一个Tag类型。所以其实一些方法比如find、find_all并不是BeautifulSoup的，而是Tag的。</li>
<li>NavigableString：继承自python中的str，用起来就跟使用python的str是一样的。</li>
<li>BeautifulSoup：继承自Tag。用来生成BeaufifulSoup树的。对于一些查找方法，比如find、select这些，其实还是Tag的。</li>
<li>Comment：这个也没什么好说，就是继承自NavigableString。</li>
</ol>
<h2 id="contents和children："><a href="#contents和children：" class="headerlink" title="contents和children："></a>contents和children：</h2><p>返回某个标签下的直接子元素，其中也包括字符串。他们两的区别是：contents返回来的是一个列表，children返回的是一个迭代器。</p>
<h2 id="string和strings、stripped-strings属性以及get-text方法"><a href="#string和strings、stripped-strings属性以及get-text方法" class="headerlink" title="string和strings、stripped_strings属性以及get_text方法"></a>string和strings、stripped_strings属性以及get_text方法</h2><ol>
<li>string：获取某个标签下的非标签字符串。返回来的是个字符串。如果这个标签下有多行字符，那么就不能获取到了。</li>
<li>strings：获取某个标签下的子孙非标签字符串。返回来的是个生成器。</li>
<li>stripped_strings：获取某个标签下的子孙非标签字符串，会去掉空白字符。返回来的是个生成器。</li>
<li>get_text：获取某个标签下的子孙非标签字符串，以普通字符串形式返回</li>
</ol>
<h2 id="find-all的使用："><a href="#find-all的使用：" class="headerlink" title="find_all的使用："></a>find_all的使用：</h2><ol>
<li>在提取标签的时候，第一个参数是标签的名字。然后如果在提取标签的时候想要使用标签属性进行过滤，那么可以在这个方法中通过关键字参数的形式，将属性的名字以及对应的值传进去。或者是使用<code>attrs</code>属性，将所有的属性以及对应的值放在一个字典中传给<code>attrs</code>属性。</li>
<li>有些时候，在提取标签的时候，不想提取那么多，那么可以使用<code>limit</code>参数。限制提取多少个。</li>
</ol>
<h2 id="find与find-all的区别："><a href="#find与find-all的区别：" class="headerlink" title="find与find_all的区别："></a>find与find_all的区别：</h2><ol>
<li>find：找到第一个满足条件的标签就返回。说白了，就是只会返回一个元素。</li>
<li>find_all:将所有满足条件的标签都返回。说白了，会返回很多标签（以列表的形式）。</li>
</ol>
<h2 id="使用find和find-all的过滤条件："><a href="#使用find和find-all的过滤条件：" class="headerlink" title="使用find和find_all的过滤条件："></a>使用find和find_all的过滤条件：</h2><ol>
<li>关键字参数：将属性的名字作为关键字参数的名字，以及属性的值作为关键字参数的值进行过滤。</li>
<li>attrs参数：将属性条件放到一个字典中，传给attrs参数。</li>
</ol>
<h2 id="获取标签的属性："><a href="#获取标签的属性：" class="headerlink" title="获取标签的属性："></a>获取标签的属性：</h2><ol>
<li><p>通过下标获取：通过标签的下标的方式。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">href = a[<span class="string">&#x27;href&#x27;</span>]</span><br></pre></td></tr></table></figure></li>
<li><p>通过attrs属性获取：示例代码：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">href = a.attrs[<span class="string">&#x27;href&#x27;</span>]</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="CSS选择器："><a href="#CSS选择器：" class="headerlink" title="CSS选择器："></a>CSS选择器：</h2><h3 id="select方法："><a href="#select方法：" class="headerlink" title="select方法："></a>select方法：</h3><p>使用以上方法可以方便的找出元素。但有时候使用<code>css</code>选择器的方式可以更加的方便。使用<code>css</code>选择器的语法，应该使用<code>select</code>方法。以下列出几种常用的<code>css</code>选择器方法：</p>
<h4 id="（1）通过标签名查找："><a href="#（1）通过标签名查找：" class="headerlink" title="（1）通过标签名查找："></a>（1）通过标签名查找：</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(soup.select(<span class="string">&#x27;a&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="（2）通过类名查找："><a href="#（2）通过类名查找：" class="headerlink" title="（2）通过类名查找："></a>（2）通过类名查找：</h4><p>通过类名，则应该在类的前面加一个<code>.</code>。比如要查找<code>class=sister</code>的标签。示例代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(soup.select(<span class="string">&#x27;.sister&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="（3）通过id查找："><a href="#（3）通过id查找：" class="headerlink" title="（3）通过id查找："></a>（3）通过id查找：</h4><p>通过id查找，应该在id的名字前面加一个＃号。示例代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(soup.select(<span class="string">&quot;#link1&quot;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="（4）组合查找："><a href="#（4）组合查找：" class="headerlink" title="（4）组合查找："></a>（4）组合查找：</h4><p>组合查找即和写 class 文件时，标签名与类名、id名进行的组合原理是一样的，例如查找 p 标签中，id 等于 link1的内容，二者需要用空格分开：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(soup.select(<span class="string">&quot;p #link1&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>直接子标签查找，则使用 &gt; 分隔：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(soup.select(<span class="string">&quot;head &gt; title&quot;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="（5）通过属性查找："><a href="#（5）通过属性查找：" class="headerlink" title="（5）通过属性查找："></a>（5）通过属性查找：</h4><p>查找时还可以加入属性元素，属性需要用中括号括起来，注意属性和标签属于同一节点，所以中间不能加空格，否则会无法匹配到。示例代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(soup.select(<span class="string">&#x27;a[href=&quot;http://example.com/elsie&quot;]&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="（6）获取内容"><a href="#（6）获取内容" class="headerlink" title="（6）获取内容"></a>（6）获取内容</h4><p>以上的 select 方法返回的结果都是列表形式，可以遍历形式输出，然后用 get_text() 方法来获取它的内容。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">soup = BeautifulSoup(html, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(soup.select(<span class="string">&#x27;title&#x27;</span>)))</span><br><span class="line"><span class="built_in">print</span>(soup.select(<span class="string">&#x27;title&#x27;</span>)[<span class="number">0</span>].get_text())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> title <span class="keyword">in</span> soup.select(<span class="string">&#x27;title&#x27;</span>):</span><br><span class="line">    <span class="built_in">print</span>(title.get_text())</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>python</category>
        <category>python爬虫</category>
      </categories>
      <tags>
        <tag>bs4</tag>
      </tags>
  </entry>
  <entry>
    <title>xpath</title>
    <url>/xpath/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>xpath（XML Path Language）是一门在XML和HTML文档中查找信息的语言，可用来在XML和HTML文档中对元素和属性进行遍历。</p>
<span id="more"></span>

<h2 id="XPath开发工具"><a href="#XPath开发工具" class="headerlink" title="XPath开发工具"></a>XPath开发工具</h2><p>Chrome插件XPath Helper。</p>
<p>安装方法：</p>
<ol>
<li>打开插件伴侣，选择插件</li>
<li>选择提取插件内容到桌面，桌面上会多一个文件夹</li>
<li>把文件夹放入想要放的路径下</li>
<li>打开谷歌浏览器，选择扩展程序，开发者模式打开，选择加载已解压的扩展程序，选择路径打开即可</li>
</ol>
<p>Firefox插件Try XPath。</p>
<h2 id="XPath节点"><a href="#XPath节点" class="headerlink" title="XPath节点"></a>XPath节点</h2><p>在 XPath 中，有七种类型的节点：元素、属性、文本、命名空间、处理指令、注释以及文档（根）节点。XML 文档是被作为节点树来对待的。树的根被称为文档节点或者根节点。</p>
<h2 id="XPath语法"><a href="#XPath语法" class="headerlink" title="XPath语法"></a>XPath语法</h2><h3 id="使用方式："><a href="#使用方式：" class="headerlink" title="使用方式："></a>使用方式：</h3><p>使用//获取整个页面当中的元素，然后写标签名，然后在写谓语进行提取，比如：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">//title[@lang=<span class="string">&#x27;en&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="需要注意的知识点："><a href="#需要注意的知识点：" class="headerlink" title="需要注意的知识点："></a>需要注意的知识点：</h3><ol>
<li><p>/和//的区别：/代表只获取子节点，//获取子孙节点，一般//用的比较多，当然也要视情况而定</p>
</li>
<li><p>contains：有时候某个属性中包含了多个值，那么可以使用contains函数，示例如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">//title[contains(@lang,<span class="string">&#x27;en&#x27;</span>)]</span><br></pre></td></tr></table></figure></li>
<li><p>谓词中下标是从1开始的，不是从0开始的</p>
</li>
</ol>
<h2 id="lxml库"><a href="#lxml库" class="headerlink" title="lxml库"></a>lxml库</h2><p>lxml 是 一个HTML/XML的解析器，主要的功能是如何解析和提取 HTML/XML 数据。</p>
<h3 id="基本使用："><a href="#基本使用：" class="headerlink" title="基本使用："></a>基本使用：</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;div&gt;</span></span><br><span class="line"><span class="string">    &lt;ul&gt;</span></span><br><span class="line"><span class="string">         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link1.html&quot;&gt;first item&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">         &lt;li class=&quot;item-inactive&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;third item&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;</span></span><br><span class="line"><span class="string">     &lt;/ul&gt;</span></span><br><span class="line"><span class="string"> &lt;/div&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 将字符串解析为html文档</span></span><br><span class="line">html = etree.HTML(text)</span><br><span class="line"><span class="built_in">print</span>(html)</span><br><span class="line"><span class="comment"># 按字符串序列化html</span></span><br><span class="line">result = etree.tostring(html).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<h3 id="从文件中读取html代码："><a href="#从文件中读取html代码：" class="headerlink" title="从文件中读取html代码："></a>从文件中读取html代码：</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#读取</span></span><br><span class="line">html = etree.parse(<span class="string">&#x27;hello.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">result = etree.tostring(html).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<h3 id="在lxml中使用xpath语法"><a href="#在lxml中使用xpath语法" class="headerlink" title="在lxml中使用xpath语法"></a>在lxml中使用xpath语法</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- hello.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item-0&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;link1.html&quot;</span>&gt;</span>first item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item-1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;link2.html&quot;</span>&gt;</span>second item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item-inactive&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;link3.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;bold&quot;</span>&gt;</span>third item<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item-1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;link4.html&quot;</span>&gt;</span>fourth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;item-0&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;link5.html&quot;</span>&gt;</span>fifth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>语法练习</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">html = etree.parse(<span class="string">&#x27;hello.html&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取所有li标签：</span></span><br><span class="line"><span class="comment"># result = html.xpath(&#x27;//li&#x27;)</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment"># for i in result:</span></span><br><span class="line"><span class="comment">#     print(etree.tostring(i))</span></span><br><span class="line"><span class="comment"># 获取所有li元素下的所有class属性的值：</span></span><br><span class="line"><span class="comment"># result = html.xpath(&#x27;//li/@class&#x27;)</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment"># 获取li标签下href为www.baidu.com的a标签：</span></span><br><span class="line"><span class="comment"># result = html.xpath(&#x27;//li/a[@href=&quot;www.baidu.com&quot;]&#x27;)</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment"># 获取li标签下所有span标签：</span></span><br><span class="line"><span class="comment"># result = html.xpath(&#x27;//li//span&#x27;)</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment"># 获取li标签下的a标签里的所有class：</span></span><br><span class="line"><span class="comment"># result = html.xpath(&#x27;//li/a//@class&#x27;)</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment"># 获取最后一个li的a的href属性对应的值：</span></span><br><span class="line"><span class="comment"># result = html.xpath(&#x27;//li[last()]/a/@href&#x27;)</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment"># 获取倒数第二个li元素的内容：</span></span><br><span class="line"><span class="comment"># result = html.xpath(&#x27;//li[last()-1]/a&#x27;)</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment"># print(result[0].text)</span></span><br><span class="line"><span class="comment"># 获取倒数第二个li元素的内容的第二种方式：</span></span><br><span class="line">result = html.xpath(<span class="string">&#x27;//li[last()-1]/a/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>python</category>
        <category>python爬虫</category>
      </categories>
      <tags>
        <tag>xpath</tag>
      </tags>
  </entry>
  <entry>
    <title>无纸化系统</title>
    <url>/%E6%97%A0%E7%BA%B8%E5%8C%96%E7%B3%BB%E7%BB%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="无纸化系统"><a href="#无纸化系统" class="headerlink" title="无纸化系统"></a>无纸化系统</h2><p>无纸化</p>
<ul>
<li>电子凭证生产<ul>
<li>数据转化PDF</li>
<li>数据加模板转化为PDF</li>
<li>虚拟打印 PDF</li>
</ul>
</li>
<li>手写签名<ul>
<li>柜外清</li>
<li>手写屏</li>
</ul>
</li>
<li>电子印章<ul>
<li>智能签章</li>
</ul>
</li>
</ul>
<span id="more"></span>

<h2 id="1-登录地址"><a href="#1-登录地址" class="headerlink" title="1 登录地址"></a>1 登录地址</h2><h3 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h3><h3 id="生产环境"><a href="#生产环境" class="headerlink" title="生产环境"></a>生产环境</h3><h3 id="注意事项（IE内核加载控件）"><a href="#注意事项（IE内核加载控件）" class="headerlink" title="注意事项（IE内核加载控件）"></a>注意事项（IE内核加载控件）</h3><h3 id="登录界面"><a href="#登录界面" class="headerlink" title="登录界面"></a>登录界面</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. 账号、密码、验证码进行简单登录，鉴权</span><br><span class="line">2. 有没有唯一登录</span><br></pre></td></tr></table></figure>

<h2 id="2-首页"><a href="#2-首页" class="headerlink" title="2 首页"></a>2 首页</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">印章、印模、用户统计</span><br><span class="line">用户视图</span><br><span class="line">印章、模块视图</span><br></pre></td></tr></table></figure>

<h2 id="3-组织机构管理"><a href="#3-组织机构管理" class="headerlink" title="3 组织机构管理"></a>3 组织机构管理</h2><h3 id="部门管理"><a href="#部门管理" class="headerlink" title="部门管理"></a>部门管理</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">增删</span><br></pre></td></tr></table></figure>

<h3 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">增删</span><br></pre></td></tr></table></figure>

<h3 id="角色管理"><a href="#角色管理" class="headerlink" title="角色管理"></a>角色管理</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rbac基于角色的访问控制</span><br></pre></td></tr></table></figure>

<h2 id="4-系统管理"><a href="#4-系统管理" class="headerlink" title="4 系统管理"></a>4 系统管理</h2><h3 id="授权信息"><a href="#授权信息" class="headerlink" title="授权信息"></a>授权信息</h3><h3 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h3><h3 id="菜单管理"><a href="#菜单管理" class="headerlink" title="菜单管理"></a>菜单管理</h3><h3 id="系统字典"><a href="#系统字典" class="headerlink" title="系统字典"></a>系统字典</h3><h2 id="5-应用系统管理"><a href="#5-应用系统管理" class="headerlink" title="5 应用系统管理"></a>5 应用系统管理</h2><h2 id="6-证书中心"><a href="#6-证书中心" class="headerlink" title="6 证书中心"></a>6 证书中心</h2><h3 id="证书登记"><a href="#证书登记" class="headerlink" title="证书登记"></a>证书登记</h3><h3 id="证书管理"><a href="#证书管理" class="headerlink" title="证书管理"></a>证书管理</h3><h2 id="7-单据中心"><a href="#7-单据中心" class="headerlink" title="7 单据中心"></a>7 单据中心</h2><h3 id="单据管理"><a href="#单据管理" class="headerlink" title="单据管理"></a>单据管理</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">	单据管理为记录BOSS业务系统办理的业务受理单、协议、犯罪告知书及相关的业务办理信息，如图7.1-1所示：</span><br><span class="line">入库信息包含业务流水号、订单编号、客户编号、手机号码、业务类型、网别、营业员、工号、部门名称、部门编码、办理时间、业务区编号、业务区名称、地市编号、地市名称、及营业员相关的国网账号信息等；</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="附件列表"><a href="#附件列表" class="headerlink" title="附件列表"></a>附件列表</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">附件列表为查看具体的业务记录相关连的签章状态的业务受理单及其他影像资料，如图7.2-1所示；具体影像展示，可点击查看，如图7.2-2所示，可点击印章，查验文档是否被篡改；</span><br></pre></td></tr></table></figure>

<h2 id="8-日志管理"><a href="#8-日志管理" class="headerlink" title="8 日志管理"></a>8 日志管理</h2><h2 id="9-印模中心"><a href="#9-印模中心" class="headerlink" title="9 印模中心"></a>9 印模中心</h2><h2 id="10-印章中心"><a href="#10-印章中心" class="headerlink" title="10 印章中心"></a>10 印章中心</h2><h2 id="11-模板中心"><a href="#11-模板中心" class="headerlink" title="11 模板中心"></a>11 模板中心</h2>]]></content>
      <categories>
        <category>点聚</category>
        <category>文档</category>
      </categories>
      <tags>
        <tag>点聚</tag>
      </tags>
  </entry>
</search>
